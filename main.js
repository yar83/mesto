(()=>{"use strict";function t(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function e(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,r(t,e,"get"))}function n(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,r(t,e,"set"),n),n}function r(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var o=new WeakMap,i=new WeakMap,a=new WeakMap,u=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakMap,f=new WeakMap,h=new WeakMap,p=new WeakMap,d=new WeakMap,v=new WeakMap,y=new WeakMap,b=new WeakMap,w=new WeakMap,m=new WeakMap,_=new WeakMap,k=new WeakMap,g=new WeakMap,E=new WeakMap,S=new WeakMap,C=new WeakSet,O=new WeakSet,W=new WeakSet,M=new WeakSet,L=new WeakSet,T=new WeakSet,j=new WeakSet,I=new WeakSet,B=new WeakSet,P=new WeakSet,q=function r(q,x,A,U){var z,F,N=this,J=U.handleCardClick,H=U.handleCardLike,G=U.handleCardDislike,K=U.handleTrashbinClick;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),P.add(this),B.add(this),I.add(this),j.add(this),T.add(this),L.add(this),M.add(this),W.add(this),O.add(this),C.add(this),o.set(this,{writable:!0,value:void 0}),i.set(this,{writable:!0,value:void 0}),a.set(this,{writable:!0,value:void 0}),u.set(this,{writable:!0,value:void 0}),s.set(this,{writable:!0,value:void 0}),c.set(this,{writable:!0,value:void 0}),l.set(this,{writable:!0,value:void 0}),f.set(this,{writable:!0,value:void 0}),h.set(this,{writable:!0,value:void 0}),p.set(this,{writable:!0,value:void 0}),d.set(this,{writable:!0,value:void 0}),v.set(this,{writable:!0,value:void 0}),y.set(this,{writable:!0,value:void 0}),b.set(this,{writable:!0,value:void 0}),w.set(this,{writable:!0,value:void 0}),m.set(this,{writable:!0,value:void 0}),_.set(this,{writable:!0,value:void 0}),k.set(this,{writable:!0,value:void 0}),g.set(this,{writable:!0,value:void 0}),E.set(this,{writable:!0,value:void 0}),S.set(this,{writable:!0,value:void 0}),F=function(){return n(N,v,t(N,C,R).call(N)),t(N,L,D).call(N),t(N,j,V).call(N),e(N,v)},(z="getCard")in this?Object.defineProperty(this,z,{value:F,enumerable:!0,configurable:!0,writable:!0}):this[z]=F,n(this,o,q.name),n(this,i,q.link),n(this,a,q._id),n(this,u,q.owner._id),n(this,s,A),n(this,l,J),n(this,f,H),n(this,h,G),n(this,p,K),n(this,d,"Изображение "+q.name),n(this,b,x._id),n(this,w,q.likes.length),n(this,m,q.likes)};function R(){return n(this,c,document.querySelector(e(this,s)).content.querySelector(".card").cloneNode(!0)),n(this,_,e(this,c).querySelector(".card__heart")),n(this,k,e(this,c).querySelector(".card__picture")),n(this,g,e(this,c).querySelector(".card__likes-number")),n(this,E,e(this,c).querySelector(".card__trashbin")),n(this,S,e(this,c).querySelector(".card__place")),t(this,W,A).call(this)&&t(this,O,x).call(this),e(this,c)}function x(){e(this,E).classList.add("card__trashbin_visible")}function A(){return e(this,b)===e(this,u)}function U(){var t=this;return e(this,m).some((function(n){return n._id===e(t,b)}))}function D(){e(this,S).textContent=e(this,o),t(this,T,z).call(this),t(this,M,U).call(this)&&t(this,B,F).call(this),e(this,k).src=e(this,i),e(this,k).setAttribute("alt",e(this,d))}function z(){e(this,g).textContent=e(this,w)}function V(){var r=this;e(this,E).addEventListener("click",(function(){e(r,p).call(r,e(r,a),e(r,v))})),e(this,_).addEventListener("click",(function(){(t(r,M,U).call(r)?e(r,h).call(r,e(r,a)):e(r,f).call(r,e(r,a))).then((function(e){n(r,w,e.likes.length),t(r,T,z).call(r),n(r,m,e.likes),t(r,M,U).call(r)?t(r,B,F).call(r):t(r,P,N).call(r)})).catch((function(t){return console.log("Ошибка: "+t)}))})),e(this,k).addEventListener("click",(function(t){e(r,l).call(r,{imgSrc:e(r,i),altText:e(r,d)})}))}function F(){e(this,_).classList.add("card__heart_color_black")}function N(){e(this,_).classList.remove("card__heart_color_black")}function J(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var H=function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),J(this,"enableValidation",(function(){r._form.addEventListener("submit",(function(t){t.preventDefault()})),r._inputList.forEach((function(t){r._setInputEventListener(t)}))})),J(this,"_setInputEventListener",(function(t){t.addEventListener("input",(function(){r._checkInputValidity(t),r.toggleButtonState()}))})),J(this,"_checkInputValidity",(function(t){!1===t.validity.valid?r._showInputError(t):r._hideInputError(t)})),J(this,"_showInputError",(function(t){var e=t.getAttribute("id"),n=r._form.querySelector(".".concat(e,"-error"));t.classList.add(r._inputErrorClass),n.style.display="block",n.textContent=t.validationMessage})),J(this,"_hideInputError",(function(t){var e=t.getAttribute("id"),n=r._form.querySelector(".".concat(e,"-error"));t.classList.remove(r._inputErrorClass),n.style.display="none",n.textContent=""})),J(this,"resetValidation",(function(){r._inputList.forEach((function(t){r._hideInputError(t)}))})),J(this,"toggleButtonState",(function(){r._hasInvalidInput()?(r._button.classList.add(r._config.inactiveButtonClass),r._button.setAttribute("disabled","")):(r._button.classList.remove(r._config.inactiveButtonClass),r._button.removeAttribute("disabled"))})),J(this,"_hasInvalidInput",(function(){return r._inputList.some((function(t){if(!1===t.validity.valid)return!0}))})),this._form=e,this._config=n,this._inputList=Array.from(e.querySelectorAll(n.inputSelector)),this._button=this._form.querySelector(this._config.submitButtonSelector)};function G(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function K(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,X(t,e,"get"))}function Q(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,X(t,e,"set"),n),n}function X(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Y=new WeakMap,Z=new WeakMap,$=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Y.set(this,{writable:!0,value:void 0}),Z.set(this,{writable:!0,value:void 0}),Q(this,Y,e),Q(this,Z,document.querySelector(n))}var e,n;return e=t,(n=[{key:"rendererItems",value:function(t){var e=this;t.forEach((function(t){return K(e,Y).call(e,t)}))}},{key:"addItem",value:function(t){K(this,Z).prepend(t)}}])&&G(e.prototype,n),t}();function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var et=function(){function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=void 0,(n="popupItem")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r,this.popupItem=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._button=this.popupItem.querySelector(".form__button")}var e,n;return e=t,(n=[{key:"open",value:function(){this.popupItem.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscClose)}},{key:"close",value:function(){this.popupItem.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}},{key:"setButtonBusyMode",value:function(t){this._button.textContent=t?"Сохранение...":"Сохранить"}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close()}},{key:"setEventListeners",value:function(){var t=this;this.popupItem.addEventListener("click",(function(e){e.target===t.popupItem&&t.close(),e.target.classList.contains("popup__close")&&t.close()}))}}])&&tt(e.prototype,n),t}();function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ot(t,e,n){return(ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=st(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function at(t,e){return!e||"object"!==nt(e)&&"function"!=typeof e?ut(t):e}function ut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,ft(t,e,"get"))}function lt(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,ft(t,e,"set"),n),n}function ft(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var ht=new WeakMap,pt=new WeakMap,dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=st(r);if(o){var n=st(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return at(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=i.call(this,t),ht.set(ut(e),{writable:!0,value:void 0}),pt.set(ut(e),{writable:!0,value:void 0}),lt(ut(e),ht,e.popupItem.querySelector(".fullszimg-popup__image")),lt(ut(e),pt,e.popupItem.querySelector(".fullszimg-popup__title")),e}return e=a,(n=[{key:"open",value:function(t,e){ot(st(a.prototype),"open",this).call(this),ct(this,ht).src=t,ct(this,pt).textContent=e}}])&&rt(e.prototype,n),a}(et);function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bt(t,e,n){return(bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=kt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function wt(t,e){return(wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function mt(t,e){return!e||"object"!==vt(e)&&"function"!=typeof e?_t(t):e}function _t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kt(t){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gt(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,St(t,e,"get"))}function Et(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,St(t,e,"set"),n),n}function St(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Ct=new WeakMap,Ot=new WeakMap,Wt=new WeakMap,Mt=new WeakMap,Lt=new WeakSet,Tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wt(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=kt(r);if(o){var n=kt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return mt(this,t)});function a(t,e){var n,r=e.handleFormSubmit;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),n=i.call(this,t),Lt.add(_t(n)),Ct.set(_t(n),{writable:!0,value:void 0}),Ot.set(_t(n),{writable:!0,value:void 0}),Wt.set(_t(n),{writable:!0,value:void 0}),Mt.set(_t(n),{writable:!0,value:void 0}),Et(_t(n),Ct,document.querySelector(t).querySelector(".form__entity")),Et(_t(n),Ot,r),Et(_t(n),Wt,gt(_t(n),Ct).querySelectorAll(".form__item")),n}return e=a,(n=[{key:"setEventListeners",value:function(){var t=this;bt(kt(a.prototype),"setEventListeners",this).call(this),gt(this,Ct).addEventListener("submit",(function(e){e.preventDefault(),gt(t,Ot).call(t,function(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}(t,Lt,jt).call(t))}))}},{key:"close",value:function(){gt(this,Ct).reset(),bt(kt(a.prototype),"close",this).call(this)}},{key:"setInitialFormData",value:function(t){gt(this,Wt).forEach((function(e,n){e.value=Object.values(t)[n]}))}}])&&yt(e.prototype,n),a}(et);function jt(){var t=this;return Et(this,Mt,{}),gt(this,Wt).forEach((function(e){gt(t,Mt)[e.name]=e.value})),gt(this,Mt)}function It(t){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(t,e,n){return(Pt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=At(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Rt(t,e){return!e||"object"!==It(e)&&"function"!=typeof e?xt(t):e}function xt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function At(t){return(At=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ut(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,zt(t,e,"get"))}function Dt(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,zt(t,e,"set"),n),n}function zt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Vt=new WeakMap,Ft=new WeakMap,Nt=new WeakMap,Jt=new WeakMap,Ht=new WeakMap,Gt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=At(r);if(o){var n=At(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Rt(this,t)});function a(t,e){var n,r=e.handleButtonClick,o=e.handleSuccessConfirm;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),n=i.call(this,t),Vt.set(xt(n),{writable:!0,value:void 0}),Ft.set(xt(n),{writable:!0,value:void 0}),Nt.set(xt(n),{writable:!0,value:void 0}),Jt.set(xt(n),{writable:!0,value:void 0}),Ht.set(xt(n),{writable:!0,value:void 0}),Dt(xt(n),Vt,r),Dt(xt(n),Ft,o),Dt(xt(n),Nt,n.popupItem.querySelector(".delcard-popup__buttonyes")),n}return e=a,(n=[{key:"setEventListeners",value:function(){var t=this;Pt(At(a.prototype),"setEventListeners",this).call(this),Ut(this,Nt).addEventListener("click",(function(){Ut(t,Vt).call(t,Ut(t,Jt)).then((function(){Ut(t,Ft).call(t,Ut(t,Ht)),t.close()})).catch((function(e){console.log("Невозможно удалить карочку: "+e),t.close()}))}))}},{key:"setCardData",value:function(t,e){Dt(this,Jt,t),Dt(this,Ht,e)}}])&&Bt(e.prototype,n),a}(et);function Kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Qt(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,Yt(t,e,"get"))}function Xt(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,Yt(t,e,"set"),n),n}function Yt(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var Zt=new WeakMap,$t=new WeakMap,te=new WeakMap,ee=function(){function t(e){var n=e.about,r=e.avatar,o=e.name;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Zt.set(this,{writable:!0,value:void 0}),$t.set(this,{writable:!0,value:void 0}),te.set(this,{writable:!0,value:void 0}),Xt(this,Zt,document.querySelector(o)),Xt(this,$t,document.querySelector(n)),Xt(this,te,document.querySelector(r))}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{name:Qt(this,Zt).textContent,about:Qt(this,$t).textContent}}},{key:"setUserInfo",value:function(t){Qt(this,Zt).textContent=t.name,Qt(this,$t).textContent=t.about}},{key:"setUserAvatar",value:function(t){Qt(this,te).src=t.avatar}}])&&Kt(e.prototype,n),t}();function ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function re(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function oe(t,e){return function(t,e){return e.get?e.get.call(t):e.value}(t,ae(t,e,"get"))}function ie(t,e,n){return function(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}(t,ae(t,e,"set"),n),n}function ae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}var ue=new WeakMap,se=new WeakMap,ce=new WeakSet,le=function(){function t(e){var n=e.baseApiUrl,r=e.token;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ce.add(this),ue.set(this,{writable:!0,value:void 0}),se.set(this,{writable:!0,value:void 0}),ie(this,ue,n),ie(this,se,r)}var e,n;return e=t,(n=[{key:"getInitialCards",value:function(){return fetch("".concat(oe(this,ue),"cards"),{headers:{authorization:oe(this,se)}}).then(re(this,ce,fe))}},{key:"getUser",value:function(){return fetch("".concat(oe(this,ue),"users/me"),{headers:{authorization:oe(this,se)}}).then(re(this,ce,fe))}},{key:"updateUserInfo",value:function(t){return fetch("".concat(oe(this,ue),"users/me"),{method:"PATCH",headers:{authorization:oe(this,se),"Content-Type":"application/json"},body:JSON.stringify({name:t.name,about:t.about})}).then(re(this,ce,fe))}},{key:"updateUserAvatar",value:function(t){return fetch("".concat(oe(this,ue),"users/me/avatar"),{method:"PATCH",headers:{authorization:oe(this,se),"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then(re(this,ce,fe))}},{key:"addNewCard",value:function(t,e){return fetch("".concat(oe(this,ue),"cards"),{method:"POST",headers:{authorization:oe(this,se),"Content-Type":"application/json"},body:JSON.stringify({name:t,link:e})}).then(re(this,ce,fe))}},{key:"likeCard",value:function(t){return fetch("".concat(oe(this,ue),"cards/likes/").concat(t),{method:"PUT",headers:{authorization:oe(this,se)}}).then(re(this,ce,fe))}},{key:"dislikeCard",value:function(t){return fetch("".concat(oe(this,ue),"cards/likes/").concat(t),{method:"DELETE",headers:{authorization:oe(this,se)}}).then(re(this,ce,fe))}},{key:"deleteCard",value:function(t){return fetch("".concat(oe(this,ue),"cards/").concat(t),{method:"DELETE",headers:{authorization:oe(this,se)}}).then(re(this,ce,fe))}}])&&ne(e.prototype,n),t}();function fe(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))}var he=document.querySelector(".profile__button-add"),pe=document.querySelector(".profile__button-edit"),de=document.querySelector(".profile__avatar-edit"),ve=document.querySelector(".form__entity_profile"),ye=document.querySelector(".form__entity_add-card"),be=document.querySelector(".form__entity_update-avatar"),we={formSelector:".form__entity",fieldsetInputsSelector:".form__items",inputSelector:".form__item",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_inactive",inputErrorClass:"form__item_type_error"},me={},_e=new H(ve,we),ke=new H(ye,we),ge=new H(be,we),Ee=new dt(".fullszimg-popup"),Se=new Gt(".delcard-popup",{handleButtonClick:function(t){return Ce.deleteCard(t)},handleSuccessConfirm:function(t){t.remove(),t=null}});Se.setEventListeners();var Ce=new le({baseApiUrl:"https://mesto.nomoreparties.co/v1/cohort-25/",token:"edd40284-3f07-410f-b675-d459a40ce2f2"}),Oe=function(t){me.name=t.name,me.about=t.about,me.avatar=t.avatar,me.cohort=t.cohort,me._id=t._id},We=new $((function(t){return We.addItem(Ie(t))}),".places__list"),Me=new ee({name:".profile__name",about:".profile__about",avatar:".profile__avatar-picture"}),Le=new Tt(".popup_edit-profile",{handleFormSubmit:function(t){Le.setButtonBusyMode(!0),Ce.updateUserInfo(t).then((function(t){Me.setUserInfo(t),Oe(t),Le.close(),Le.setButtonBusyMode(!1)})).catch((function(t){console.log("Невозможно обновить данные пользователя: "+t),Le.close(),Le.setButtonBusyMode(!1)}))}}),Te=new Tt(".popup_add-card",{handleFormSubmit:function(t){var e=t.name,n=t.link;Te.setButtonBusyMode(!0),console.log(e,n),Ce.addNewCard(e,n).then((function(t){We.addItem(Ie(t)),Te.close(),Te.setButtonBusyMode(!1)})).catch((function(t){console.log("Невозможно добавить новую карточку: "+t),Te.close(),Te.setButtonBusyMode(!1)}))}}),je=new Tt(".popup_update-avatar",{handleFormSubmit:function(t){var e=t.link;je.setButtonBusyMode(!0),Ce.updateUserAvatar(e).then((function(t){Me.setUserAvatar(t),je.close(),je.setButtonBusyMode(!1)})).catch((function(t){console.log("Невозможно обновить аватар: "+t),je.close(),je.setButtonBusyMode(!1)}))}}),Ie=function(t){return new q(t,me,"#card-template",{handleCardClick:function(t){Ee.open(t.imgSrc,t.altText)},handleCardLike:function(t){return Ce.likeCard(t)},handleCardDislike:function(t){return Ce.dislikeCard(t)},handleTrashbinClick:function(t,e){Se.open(),Se.setCardData(t,e)}}).getCard()};Promise.all([Ce.getUser(),Ce.getInitialCards()]).then((function(t){Oe(t[0]),Me.setUserInfo(me),Me.setUserAvatar(me),We.rendererItems(t[1])})).catch((function(t){return console.log("Невозможно получить начальные данные с сервера "+t)})),Ee.setEventListeners(),Le.setEventListeners(),Te.setEventListeners(),je.setEventListeners(),pe.addEventListener("click",(function(){Le.open(),_e.resetValidation();var t=Me.getUserInfo();Le.setInitialFormData(t)})),he.addEventListener("click",(function(){Te.open(),ke.resetValidation(),ke.toggleButtonState()})),de.addEventListener("click",(function(){je.open(),ge.resetValidation(),ge.toggleButtonState()})),_e.enableValidation(),ke.enableValidation(),ge.enableValidation()})();